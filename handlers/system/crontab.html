{% extends base.html %}

{% block body %}

<h3>任务管理</h3>

{% set REPEAT_TYPE_DICT = dict(interval="间隔秒", day="每天") %}

<form method="GET">
<input class="hide" name="option" value="add"/>
<table class="table col-md-12">

    <tr>
        <th>编号</th>
        <th>重复</th>
        <th>任务URL(如/test)</th>
        <th>执行表达式</th>
        <th>操作</th>
    </tr>
    {% set index = -1 %}
    {% for index, name in enumerate(sorted(task_dict)) %}
    {% set task = task_dict[name] %}
    <tr>
        <td>{{index+1}}</td>
        <td>{{ REPEAT_TYPE_DICT.get(task.repeat_type) }}</td>
        <td>{{task.url}}</td>
        <td>{{task.pattern}}</td>
        <td><a href="/system/crontab?option=del&url={{task.url}}">删除</a></td>
    </tr>
    {% end %}

    <tr>
        <td>{{index+2}}</td>
        <td><select name="repeat_type">
            <option value="interval">间隔秒</option>
            <option value="day">每天</option>
        </select></td>
        <td><input type="text" name="url"></td>
        <td><input type="text" name="pattern"></td>
        <td><input type="submit" value="添加"></td>
    </tr>
</table>
</form>

{% end %}