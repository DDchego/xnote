{% extends base.html %}

{% block head %}
<style type="text/css">
    .error-div {
        color:red;
    }
</style>
<script type="text/javascript" src="/static/js/upload.js"></script>
{% end %}

{% block body %}

{% init app_list = [] %}

<h2 class="top-offset-1">App包上传</h2>
<div class="top-offset-1">
<table class="table col-md-12 top-offset-1">
    <tr>
        <th>包名</th>
        <th>大小</th>
    </tr>
    {% for app in app_list %}
        <tr>
            <td><a href="/app/{{app.app_name}}/index.html">{{app.app_name}}</a></td>
            <td>{{app.size}}</td>
        </tr>
    {% end %}
</table>
</div>

<div class="error-div">{{error}}</div>

<div class="top-offset-1">
<form enctype="multipart/form-data" method="POST">
    <input type="file" name="file" id="fileId"/>
    <input type="button" value="上传app包" id="submitId"/>
    <span id="progressNumber"></span>
    <div id="resultLink"></div>
</form>
</div>

<script type="text/javascript">
    $("#submitId").on("click", function () {
        uploadFile("fileId", "file", "/system/upload_app", function (evt) {
            /* This event is raised when the server send back a response */
            // alert(evt.target.responseText);
            var responseText = evt.target.responseText;
            document.getElementById("resultLink").innerHTML = "上传成功";

            setTimeout(function () {
                location.reload();
            }, 500)
        });
    })
</script>

{% end %}
