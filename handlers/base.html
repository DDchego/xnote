<!DOCTYPE html>
<html><head>

<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1.0,user-scalable=0"/>

<title>Xnote</title>
<style>
body, html { 
  height: 100%; 
  overflow: hidden;
}

#navMenubox, .navMenu, .sub-menu {
  margin: 0;
  padding: 0;
}

body { 
  font: 14px "微软雅黑", "FontAwesome", "Arial Narrow", HELVETICA; 
  -webkit-text-size-adjust: 100%; 
  margin: 0; 
  padding: 0;
}

.navMenu> li, .sub-menu> li { 
  list-style: none 
}
a { text-decoration: none; }


.header {
  width: 100%;
  background-color: #eee;
  position: fixed;
  left: 0px;
  top: 0px;
}

/* navMenu */
.navMenubox { 
  width: 220px;
  background: #1c2229; 
  height:100%; 
  float: left;
  padding-top: 28px;
}

.main {
  padding-top: 28px;
  width: auto;
  height: 100%;
  overflow: auto;
}

.footer {
  float: left;
  width: 100%;
  height: 50px;
}

@media screen and (max-width: 600px) {
    .navMenubox {
      margin-left: -220px;
    }
}

.navMenu-top { 
  padding: 10px; 
  color: #fff; 
  border-bottom: 1px solid rgba(255,255,255,.1) 
}

.navMenu> li { 
    display: block; 
    margin: 0; 
    padding: 0; 
    border: 0px; 
    width: 220px;
}

.navMenu>li>a { 
    display: block;
    overflow: hidden; 
    padding-left: 0px; 
    line-height: 40px; 
    color: #ABB1B7; 
    transition: all .3s; 
    position: relative; 
    text-decoration: none; 
    font-size: 17px; 
    border-top: 1px solid #222932; 
    border-bottom: 2px solid #191e24; 
    padding-left: 15px;
}

.navMenu > li:nth-of-type(1)> a { 
  border-top: 1px solid transparent; 
}
.navMenu > li:last-child > a { 
  border-bottom: 1px solid transparent; 
}
.navMenu>li>a>i { 
  font-size: 20px; 
  float: left; 
  font-style: normal; 
  margin: 0 5px; 
}

.navMenu li a .arrow:before { 
    display: block; 
    float: right; 
    margin-top: 1px; 
    margin-right: 15px; 
    display: inline; 
    font-size: 16px; 
    font-family: Arial, Helvetica, sans-serif;
    /* font-family: FontAwesome; */
    height: auto; 
    /* content: "\f105"; */
    content: "+";
    font-weight: 300; 
    text-shadow: none; 
}

.navMenu li a .arrow.open:before { 
    float: right; 
    margin-top: 1px; 
    margin-right: 15px; 
    display: inline; /* font-family: FontAwesome;*/ 
    height: auto; 
    font-size: 16px; 
    /* content: "\f107"; */
    content: "-";
    font-weight: 300; 
    text-shadow: none; 
}

.navMenu>li>a.active, .navMenu>li>a:hover { 
  color: #FFF; 
  background: #12181b; 
}
.navMenu>li>ul.sub-menu, .navMenu>li>ul.sub-menu>li>ul.sub-menu { 
  display: none; 
  list-style: none; 
  clear: both; 
  margin: 8px 0px 0px 10px; 
  padding-bottom: 5px; 
}
.navMenu>li.active > ul.sub-menu, .navMenu>li>ul.sub-menu>li.active >ul.sub-menu { }
.navMenu>li>ul.sub-menu li { background: none; margin: 0px; padding: 0px; }

.navMenu>li>ul.sub-menu li>a { 
    display: block; 
    font-size: 16px; 
    line-height: 36px; 
    padding-left: 20px; 
    color: #ABB1B7; 
    clear: both; 
}

.navMenu>li>ul.sub-menu li>a.active, .navMenu>li>ul.sub-menu li>a:hover, .navMenu>li>ul.sub-menu>li.active >a { color: #FFF; background: #12181b; }

#toggleMenuBtn {
    padding: 3px;
    border-style: solid;
    background: lightblue;
}

/*---------------------*/
</style>

<link rel="shortcut icon" href="/static/favicon.ico"/>
<link rel="bookmark" href="/static/favicon.ico"/>
<link rel="stylesheet" href="/static/css/xnote.css"/>
<link rel="stylesheet" href="/static/css/font-awesome.min.css"/>
<script src="/static/lib/jquery/jquery-1.12.4.min.js"></script>
<script type="text/javascript">
  window.xuser = "{{_user_name}}";
</script>
<script type="text/javascript" src="/static/js/utils.js"></script>
<script type="text/javascript" src="/system/stats"></script>
<script type="text/javascript" src="/static/js/xnote-ui.js"></script>

  {% block head %} {% end %}

</head>
<body>
<div class="header">
  <div class="toggleMenu" style="margin-left: 15px; cursor: pointer;">
  <i class="fa fa-bars fa-2x"></i>
  </div>
</div>

<div class="navMenubox">
  <div style="overflow: hidden; width: 100%; height: 100%;">
    <ul class="navMenu">
      <li>
        <a href="/search/search">
            <span>搜索</span>
        </a> 
      </li>
      <li> 
        <a href="javascript:;" class="afinve" id="navFile"> 
            <span class="">知识</span>
            <span class="arrow"></span>
        </a>
        <ul class="sub-menu">
          <li><a href="/file/group/bookmark">收藏</a></li>
          <li><a href="/file/group"><span>分组</span></a></li>
          <li><a href="/file/recent_edit"><span>最近更新</span></a></li>
          <!-- <li><a href="/file/library">图书馆</a></li> -->
        </ul>
      </li>

      {% if _has_login %}
      <li><a href="/tools/message?status=created">消息</a></li>
      {% end %}

      {% if _is_admin %}
      <li>
          <a href="/fs_data" class="afinve">
            <span>文件</span>
          </a> 
      </li>
      {% end %}

      <li>
          <a href="javascript:;" class="afinve" id="navSystem">
            <span>系统</span>
            <span class="arrow"></span>
          </a> 

          <ul class="sub-menu">
              <li><a href="/system/system"><span>系统</span></a></li>
              {%if _is_admin %}
              <li><a href="/system/script_admin"><span>脚本</span></a></li>
              <li><a href="/system/crontab">定时任务</a></li>
              {% end %}
              <li><a href="/tools/date"><span>日历</span></a></li>
          </ul>
      </li>

      <li>
        {% if not _has_login %}
          <a href="/login" class="afinve">
            <span>登陆</span>
          </a> 
        {% else %}
          <a href="/logout" class="afinve">
            <span style="color: red;">登出</span>
          </a> 
        {% end %}
      </li>
    </ul>
    <div id="poweredBy" style="position: absolute; bottom: 50px; left: 10px; color: #fff; ">
      Powered by <a style="color: #fff; text-decoration: underline;" href="https://gitee.com/xupingmao/xnote">Xnote</a>
    </div>
  </div>
</div>

<div class="main">
  {% block body %} {% end %}
  <div class="footer"></div>
</div>
<!-- Main Part End -->
<div class="x-dialog-background"></div>

<script>

$(function() {
  function expandMenu(ele, delay) {
    if (delay == undefined) {
      delay = 0;
    }
    var parent = ele.parent().parent(); //获取当前页签的父级的父级
    var labeul = ele.parent("li").find(">ul");
    if (ele.parent().hasClass('open') == false) {
      //展开未展开
      parent.find('ul').slideUp(delay);
      parent.find("li").removeClass("open");
      parent.find('li a').removeClass("active").find(".arrow").removeClass("open");
      ele.parent("li").addClass("open").find(labeul).slideDown(delay);
      ele.addClass("active").find(".arrow").addClass("open")
    } else {
      ele.parent("li").removeClass("open").find(labeul).slideUp(delay);
      if (ele.parent().find("ul").length > 0) {
        ele.removeClass("active").find(".arrow").removeClass("open");
      } else {
        ele.addClass("active");
      }
    }
  }
  // nav收缩展开
  $('.navMenu li a').on('click',
    function() {
      expandMenu($(this), 300);
  });


  function showSideBar() {
    $(".navMenubox").animate({"margin-left": "0px"});
    $("#poweredBy").show();
  }

  function hideSideBar() {
    $(".navMenubox").animate({"margin-left": "-220px"});
    $("#poweredBy").hide();
  }

  function checkResize() {
    if ($(".navMenubox").is(":animated")) {
      return;
    }
    if (window.innerWidth < 700) {
      // 移动端，兼容下不支持@media的浏览器 
      hideSideBar();
    } else {
      showSideBar();
    }
  }

  checkResize();

  function toggleMenu() {
    var marginLeft = $(".navMenubox").css("margin-left");
    if (marginLeft == "0px") {
      hideSideBar();
    } else {
      showSideBar();
    }
  }

  $(".toggleMenu").on("click", function () {
    toggleMenu();
  });

  var pathname = location.pathname;
  if (/\/file\/.*/.test(pathname)) {
    expandMenu($("#navFile"));
  }
  if (pathname != "/tools/message"
      && (/\/system\/.*/.test(pathname) 
      || /\/tools\/.*/.test(pathname))) {
    expandMenu($("#navSystem"));
  }

  // $(window).resize(function () {
  //   checkResize();
  // });
});
</script>
</body>
</html>
